import{c as h,a as d}from"./boolbase.d0cdbeca.js";import{r as x,t as k,A as g,m as $,l as b,h as j,a as v}from"./mathjax-full.692d375f.js";import{c as M}from"./juice.250ed92e.js";var A=h&&h.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const O=$,S=k,C=x(),L=b,w=j,y=g,D=v,H=A(M);function p(e,n,c){const i=(0,L.liteAdaptor)(),r=(0,w.RegisterHTMLHandler)(i);(0,D.AssistiveMmlHandler)(r);const l=O.mathjax.document(e,n),t=i.outerHTML(l.convert(e,c)),o=i.outerHTML(n.OutputJax.styleSheet(l));return(0,H.default)(t+o)}function _(e,n){let c=e.posMax,i=!0,r=!0;const l=n>0?e.src.charCodeAt(n-1):-1,t=n+1<=c?e.src.charCodeAt(n+1):-1;return(l===32||l===9||t>=48&&t<=57)&&(r=!1),(t===32||t===9)&&(i=!1),{can_open:i,can_close:r}}function I(e,n){if(e.src[e.pos]!=="$")return!1;let c=_(e,e.pos);if(!c.can_open)return n||(e.pending+="$"),e.pos+=1,!0;const i=e.pos+1;let r=i;for(;(r=e.src.indexOf("$",r))!==-1;){let l=r-1;for(;e.src[l]==="\\";)l-=1;if((r-l)%2==1)break;r+=1}if(r===-1)return n||(e.pending+="$"),e.pos=i,!0;if(r-i===0)return n||(e.pending+="$$"),e.pos=i+1,!0;if(c=_(e,r),!c.can_close)return n||(e.pending+="$"),e.pos=i,!0;if(!n){const l=e.push("math_inline","math",0);l.markup="$",l.content=e.src.slice(i,r)}return e.pos=r+1,!0}function P(e,n,c,i){let r,l,t=!1,o=e.bMarks[n]+e.tShift[n],s=e.eMarks[n],u="";if(o+2>s||e.src.slice(o,o+2)!=="$$")return!1;o+=2;let a=e.src.slice(o,s);if(i)return!0;for(a.trim().slice(-2)==="$$"&&(a=a.trim().slice(0,-2),t=!0),r=n;!t&&(r++,!(r>=c||(o=e.bMarks[r]+e.tShift[r],s=e.eMarks[r],o<s&&e.tShift[r]<e.blkIndent)));)e.src.slice(o,s).trim().slice(-2)==="$$"&&(l=e.src.slice(0,s).lastIndexOf("$$"),u=e.src.slice(o,l),t=!0);e.line=r+1;const f=e.push("math_block","math",0);return f.block=!0,f.content=(a&&a.trim()?a+`
`:"")+e.getLines(n+1,r,e.tShift[n],!0)+(u&&u.trim()?u:""),f.map=[n,e.line],f.markup="$$",!0}function m(e,n){const c={InputJax:new S.TeX(Object.assign({packages:y.AllPackages},n==null?void 0:n.tex)),OutputJax:new C.SVG(Object.assign({fontCache:"none"},n==null?void 0:n.svg))},i={display:!1};e.inline.ruler.after("escape","math_inline",I),e.block.ruler.after("blockquote","math_block",P,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=function(r,l){return i.display=!1,p(r[l].content,c,i)},e.renderer.rules.math_block=function(r,l){return i.display=!0,p(r[l].content,c,i)}}m.default=m;var T=m;const V=d(T);export{V as m};
